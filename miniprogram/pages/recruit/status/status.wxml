<!--pages/anchor/apply-status/apply-status.wxml-->
<view class="container" wx:if="{{candidate}}">

  <!-- 顶部横幅 -->
  <view class="header-banner">
    <view class="banner-slash"></view>
    <text class="banner-text">APPLICATION STATUS</text>
  </view>

  <!-- 进度条 (6阶段) -->
  <view class="progress-section">
    <view class="progress-steps">
      <view class="step-item {{currentStep >= 1 ? 'active' : ''}}">
        <view class="step-circle">1</view>
        <text class="step-text">待审核</text>
      </view>
      <view class="step-item {{currentStep >= 2 ? 'active' : ''}}">
        <view class="step-circle">2</view>
        <text class="step-text">已安排面试</text>
      </view>
      <view class="step-item {{currentStep >= 3 ? 'active' : ''}}">
        <view class="step-circle">3</view>
        <text class="step-text">已完成测试</text>
      </view>
      <view class="step-item {{currentStep >= 4 ? 'active' : ''}}">
        <view class="step-circle">4</view>
        <text class="step-text">面试评价中</text>
      </view>
      <view class="step-item {{currentStep >= 5 ? 'active' : ''}}">
        <view class="step-circle">5</view>
        <text class="step-text">已评级</text>
      </view>
      <view class="step-item {{currentStep >= 6 ? 'active' : ''}}">
        <view class="step-circle">6</view>
        <text class="step-text">已签约</text>
      </view>
    </view>
  </view>

  <!-- 当前状态卡片 -->
  <view class="status-card">
    <view class="status-icon">{{statusConfig[candidate.status].icon}}</view>
    <view class="status-info">
      <text class="status-label">当前状态</text>
      <text class="status-value">{{statusConfig[candidate.status].text}}</text>
    </view>
    <view class="status-accent"></view>
  </view>

  <!-- AI评分卡片 -->
  <view class="score-card">
    <view class="card-header">
      <view class="header-slash"></view>
      <text class="header-title">AI EVALUATION</text>
    </view>

    <view class="score-grid">
      <view class="score-item">
        <text class="score-label">综合评分</text>
        <view class="score-number-wrapper">
          <text class="score-number-huge">{{candidate.aiScore.overallScore}}</text>
          <text class="score-unit">/100</text>
        </view>
      </view>

      <view class="score-row">
        <view class="score-sub-item">
          <text class="score-sub-label">形象</text>
          <text class="score-sub-number">{{candidate.aiScore.faceScore}}</text>
        </view>
        <view class="score-sub-item">
          <text class="score-sub-label">才艺</text>
          <text class="score-sub-number">{{candidate.aiScore.talentScore}}</text>
        </view>
      </view>
    </view>

    <view class="tags-row">
      <view class="tag" wx:for="{{candidate.aiScore.tags}}" wx:key="index">
        {{item}}
      </view>
    </view>

    <view class="recommendation">
      <text class="recommendation-label">AI建议：</text>
      <text class="recommendation-text">{{candidate.aiScore.recommendation}}</text>
    </view>
  </view>

  <!-- 基本信息卡片 -->
  <view class="info-card">
    <view class="card-header">
      <view class="header-slash"></view>
      <text class="header-title">BASIC INFO</text>
    </view>

    <view class="info-row">
      <text class="info-label">艺名</text>
      <text class="info-value">{{candidate.basicInfo.artName}}</text>
    </view>
    <view class="info-row">
      <text class="info-label">年龄</text>
      <text class="info-value">{{candidate.basicInfo.age}}岁</text>
    </view>
    <view class="info-row">
      <text class="info-label">性别</text>
      <text class="info-value">{{candidate.basicInfo.gender}}</text>
    </view>
    <view class="info-row">
      <text class="info-label">手机</text>
      <text class="info-value">{{candidate.basicInfo.phone}}</text>
    </view>
    <view class="info-row">
      <text class="info-label">城市</text>
      <text class="info-value">{{candidate.basicInfo.city}}</text>
    </view>
    <view class="info-row">
      <text class="info-label">申请时间</text>
      <text class="info-value">{{candidate.createdAt}}</text>
    </view>
  </view>

  <!-- HR审核信息 -->
  <view class="review-card" wx:if="{{candidate.hrReview}}">
    <view class="card-header">
      <view class="header-slash"></view>
      <text class="header-title">HR REVIEW</text>
    </view>

    <view class="review-result">
      <text class="review-label">审核结果：</text>
      <text class="review-status review-{{candidate.hrReview.result}}">
        {{candidate.hrReview.result === 'pass' ? '通过' : candidate.hrReview.result === 'reject' ? '未通过' : '待定'}}
      </text>
    </view>

    <view class="review-comment" wx:if="{{candidate.hrReview.comment}}">
      <text class="comment-label">审核意见：</text>
      <text class="comment-text">{{candidate.hrReview.comment}}</text>
    </view>

    <view class="review-time">
      <text class="time-text">审核时间：{{candidate.hrReview.reviewAt}}</text>
    </view>
  </view>

  <!-- Agent审核信息 -->
  <view class="review-card" wx:if="{{candidate.agentReview}}">
    <view class="card-header">
      <view class="header-slash"></view>
      <text class="header-title">AGENT REVIEW</text>
    </view>

    <view class="review-result">
      <text class="review-label">审核结果：</text>
      <text class="review-status review-{{candidate.agentReview.result}}">
        {{candidate.agentReview.result === 'pass' ? '通过' : candidate.agentReview.result === 'reject' ? '未通过' : '待定'}}
      </text>
    </view>

    <view class="review-comment" wx:if="{{candidate.agentReview.comment}}">
      <text class="comment-label">审核意见：</text>
      <text class="comment-text">{{candidate.agentReview.comment}}</text>
    </view>

    <view class="review-time">
      <text class="time-text">审核时间：{{candidate.agentReview.reviewAt}}</text>
    </view>
  </view>

  <!-- 底部按钮 -->
  <view class="footer-actions">
    <button class="btn-secondary" bindtap="backToHome">返回首页</button>
    <button
      class="btn-workspace"
      wx:if="{{candidate.status === 'signed' || candidate.status === 'training' || candidate.status === 'active'}}"
      bindtap="enterWorkspace"
    >
      进入工作台 →
    </button>
    <button class="btn-primary" bindtap="contactHR">联系HR</button>
  </view>

</view>

<!-- 加载中 -->
<view class="empty-state" wx:if="{{!candidate}}">
  <text class="empty-text">加载中...</text>
</view>
