<!--pages/hr/candidate-detail/candidate-detail.wxml-->
<view class="container" wx:if="{{candidate}}">

  <!-- é¡¶éƒ¨æ¨ªå¹… -->
  <view class="header-banner">
    <view class="banner-slash"></view>
    <text class="banner-text">CANDIDATE DETAIL</text>
  </view>

  <!-- AIè¯„åˆ†å¡ç‰‡ -->
  <view class="score-card">
    <view class="card-header">
      <view class="header-slash"></view>
      <text class="header-title">AI EVALUATION</text>
    </view>

    <view class="score-main">
      <view class="score-circle">
        <text class="score-number">{{candidate.aiScore.overallScore}}</text>
        <text class="score-label">ç»¼åˆè¯„åˆ†</text>
      </view>

      <view class="score-details">
        <view class="score-item">
          <text class="item-label">å½¢è±¡åˆ†</text>
          <text class="item-value">{{candidate.aiScore.faceScore}}</text>
        </view>
        <view class="score-item">
          <text class="item-label">æ‰è‰ºåˆ†</text>
          <text class="item-value">{{candidate.aiScore.talentScore}}</text>
        </view>
      </view>
    </view>

    <view class="tags-row">
      <view class="tag" wx:for="{{candidate.aiScore.tags}}" wx:key="index">
        {{item}}
      </view>
    </view>

    <view class="recommendation">
      <text class="rec-label">AIå»ºè®®ï¼š</text>
      <text class="rec-text">{{candidate.aiScore.recommendation}}</text>
    </view>
  </view>

  <!-- åŸºæœ¬ä¿¡æ¯ -->
  <view class="info-card">
    <view class="card-header">
      <view class="header-slash"></view>
      <text class="header-title">BASIC INFO</text>
    </view>

    <view class="info-grid">
      <view class="info-item">
        <text class="info-label">çœŸå®å§“å</text>
        <text class="info-value">{{candidate.basicInfo.name}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">è‰ºå</text>
        <text class="info-value">{{candidate.basicInfo.artName}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">å¹´é¾„</text>
        <text class="info-value">{{candidate.basicInfo.age}}å²</text>
      </view>
      <view class="info-item">
        <text class="info-label">æ€§åˆ«</text>
        <text class="info-value">{{candidate.basicInfo.gender}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">èº«é«˜</text>
        <text class="info-value">{{candidate.basicInfo.height}}cm</text>
      </view>
      <view class="info-item">
        <text class="info-label">ä½“é‡</text>
        <text class="info-value">{{candidate.basicInfo.weight}}kg</text>
      </view>
      <view class="info-item">
        <text class="info-label">æ‰‹æœº</text>
        <text class="info-value">{{candidate.basicInfo.phone}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">åŸå¸‚</text>
        <text class="info-value">{{candidate.basicInfo.city}}</text>
      </view>
    </view>
  </view>

  <!-- ç…§ç‰‡å±•ç¤º -->
  <view class="photos-card" wx:if="{{candidate.images}}">
    <view class="card-header">
      <view class="header-slash"></view>
      <text class="header-title">PHOTOS</text>
    </view>

    <view class="photos-grid">
      <image
        class="photo-item"
        src="{{candidate.images.face}}"
        mode="aspectFill"
        data-url="{{candidate.images.face}}"
        bindtap="previewImage"
        wx:if="{{candidate.images.face}}"
      />
      <image
        class="photo-item"
        src="{{candidate.images.fullBody}}"
        mode="aspectFill"
        data-url="{{candidate.images.fullBody}}"
        bindtap="previewImage"
        wx:if="{{candidate.images.fullBody}}"
      />
    </view>
  </view>

  <!-- æ‰è‰ºä¿¡æ¯ -->
  <view class="info-card">
    <view class="card-header">
      <view class="header-slash"></view>
      <text class="header-title">TALENT INFO</text>
    </view>

    <view class="info-grid">
      <view class="info-item">
        <text class="info-label">ä¸»ä¿®æ‰è‰º</text>
        <text class="info-value">{{candidate.talent.mainTalent}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">æ‰è‰ºç­‰çº§</text>
        <text class="info-value">Lv.{{candidate.talent.level}}</text>
      </view>
    </view>

    <view class="works-section" wx:if="{{candidate.talent.works && candidate.talent.works.length > 0}}">
      <text class="works-label">ä»£è¡¨ä½œå“ï¼š</text>
      <text class="works-text">{{candidate.talent.works[0]}}</text>
    </view>
  </view>

  <!-- ç»éªŒä¿¡æ¯ -->
  <view class="info-card">
    <view class="card-header">
      <view class="header-slash"></view>
      <text class="header-title">EXPERIENCE</text>
    </view>

    <view class="info-grid">
      <view class="info-item">
        <text class="info-label">ç›´æ’­ç»éªŒ</text>
        <text class="info-value">{{candidate.experience.hasExperience ? 'æœ‰' : 'æ— '}}</text>
      </view>
      <view class="info-item" wx:if="{{candidate.experience.maxFans > 0}}">
        <text class="info-label">æœ€é«˜ç²‰ä¸</text>
        <text class="info-value">{{candidate.experience.maxFans}}</text>
      </view>
    </view>
  </view>

  <!-- æœŸæœ›ä¿¡æ¯ -->
  <view class="info-card">
    <view class="card-header">
      <view class="header-slash"></view>
      <text class="header-title">EXPECTATION</text>
    </view>

    <view class="info-grid">
      <view class="info-item">
        <text class="info-label">æœŸæœ›è–ªèµ„</text>
        <text class="info-value">{{candidate.expectation.salaryRange}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">æŠ•å…¥æ—¶é—´</text>
        <text class="info-value">{{candidate.expectation.timeCommitment}}</text>
      </view>
    </view>

    <view class="goals-section" wx:if="{{candidate.personality.goals}}">
      <text class="goals-label">èŒä¸šç›®æ ‡ï¼š</text>
      <text class="goals-text">{{candidate.personality.goals}}</text>
    </view>
  </view>

  <!-- HRå®¡æ ¸è¡¨å• -->
  <view class="review-form">
    <view class="card-header">
      <view class="header-slash"></view>
      <text class="header-title">HR REVIEW</text>
    </view>

    <view class="form-field">
      <text class="field-label">å®¡æ ¸ç»“æœ *</text>
      <picker
        mode="selector"
        range="{{resultOptions}}"
        range-key="label"
        value="{{resultIndex}}"
        bindchange="onResultChange"
      >
        <view class="picker-display">
          {{resultOptions[resultIndex].label}}
        </view>
      </picker>
    </view>

    <view class="form-field">
      <text class="field-label">å®¡æ ¸æ„è§ *</text>
      <textarea
        class="field-textarea"
        placeholder="è¯·è¾“å…¥å®¡æ ¸æ„è§"
        value="{{reviewForm.comment}}"
        data-field="comment"
        bindinput="onInput"
      />
    </view>

    <view class="form-field">
      <text class="field-label">å»ºè®®è–ªèµ„</text>
      <input
        class="field-input"
        placeholder="å¦‚ï¼š5000-8000"
        value="{{reviewForm.suggestedSalary}}"
        data-field="suggestedSalary"
        bindinput="onInput"
      />
    </view>

    <!-- é¢è¯•å®‰æ’ï¼ˆä»…å½“å®¡æ ¸é€šè¿‡æ—¶æ˜¾ç¤ºï¼‰ -->
    <view class="interview-section" wx:if="{{reviewForm.result === 'pass'}}">
      <view class="section-divider">
        <view class="divider-line"></view>
        <text class="divider-text">é¢è¯•å®‰æ’</text>
        <view class="divider-line"></view>
      </view>

      <!-- é¢è¯•å®˜é€‰æ‹© -->
      <view class="form-field">
        <text class="field-label">åˆ†é…é¢è¯•å®˜ *</text>
        <text class="field-hint">è¯·ä¸ºå€™é€‰äººåˆ†é…5ä½é¢è¯•å®˜</text>
      </view>

      <!-- æ‘„åƒå¸ˆ -->
      <view class="interviewer-group">
        <view class="interviewer-label">
          <text class="label-icon">ğŸ“¸</text>
          <text class="label-text">æ‘„åƒå¸ˆ *</text>
        </view>
        <picker
          mode="selector"
          range="{{photographerList}}"
          range-key="name"
          value="{{photographerIndex}}"
          bindchange="onInterviewerChange"
          data-role="photographer"
        >
          <view class="interviewer-picker">
            {{photographerIndex >= 0 ? photographerList[photographerIndex].name : 'è¯·é€‰æ‹©æ‘„åƒå¸ˆ'}}
          </view>
        </picker>
      </view>

      <!-- èˆè¹ˆå¯¼å¸ˆ -->
      <view class="interviewer-group">
        <view class="interviewer-label">
          <text class="label-icon">ğŸ’ƒ</text>
          <text class="label-text">èˆè¹ˆå¯¼å¸ˆ *</text>
        </view>
        <picker
          mode="selector"
          range="{{danceTeacherList}}"
          range-key="name"
          value="{{danceTeacherIndex}}"
          bindchange="onInterviewerChange"
          data-role="dance_teacher"
        >
          <view class="interviewer-picker">
            {{danceTeacherIndex >= 0 ? danceTeacherList[danceTeacherIndex].name : 'è¯·é€‰æ‹©èˆè¹ˆå¯¼å¸ˆ'}}
          </view>
        </picker>
      </view>

      <!-- åŒ–å¦†å¸ˆ -->
      <view class="interviewer-group">
        <view class="interviewer-label">
          <text class="label-icon">ğŸ’„</text>
          <text class="label-text">åŒ–å¦†å¸ˆ *</text>
        </view>
        <picker
          mode="selector"
          range="{{makeupArtistList}}"
          range-key="name"
          value="{{makeupArtistIndex}}"
          bindchange="onInterviewerChange"
          data-role="makeup_artist"
        >
          <view class="interviewer-picker">
            {{makeupArtistIndex >= 0 ? makeupArtistList[makeupArtistIndex].name : 'è¯·é€‰æ‹©åŒ–å¦†å¸ˆ'}}
          </view>
        </picker>
      </view>

      <!-- é€ å‹å¸ˆ -->
      <view class="interviewer-group">
        <view class="interviewer-label">
          <text class="label-icon">âœ¨</text>
          <text class="label-text">é€ å‹å¸ˆ *</text>
        </view>
        <picker
          mode="selector"
          range="{{stylistList}}"
          range-key="name"
          value="{{stylistIndex}}"
          bindchange="onInterviewerChange"
          data-role="stylist"
        >
          <view class="interviewer-picker">
            {{stylistIndex >= 0 ? stylistList[stylistIndex].name : 'è¯·é€‰æ‹©é€ å‹å¸ˆ'}}
          </view>
        </picker>
      </view>

      <!-- ç»çºªäºº -->
      <view class="interviewer-group">
        <view class="interviewer-label">
          <text class="label-icon">ğŸ¤</text>
          <text class="label-text">ç»çºªäºº *</text>
        </view>
        <picker
          mode="selector"
          range="{{agentList}}"
          range-key="name"
          value="{{agentIndex}}"
          bindchange="onInterviewerChange"
          data-role="agent"
        >
          <view class="interviewer-picker">
            {{agentIndex >= 0 ? agentList[agentIndex].name : 'è¯·é€‰æ‹©ç»çºªäºº'}}
          </view>
        </picker>
      </view>

      <!-- é¢è¯•æ—¥æœŸæ—¶é—´ -->
      <view class="form-field">
        <text class="field-label">é¢è¯•æ—¥æœŸ *</text>
        <picker
          mode="date"
          value="{{reviewForm.interviewDate}}"
          start="{{todayDate}}"
          bindchange="onDateChange"
        >
          <view class="picker-display">
            {{reviewForm.interviewDate || 'è¯·é€‰æ‹©é¢è¯•æ—¥æœŸ'}}
          </view>
        </picker>
      </view>

      <view class="form-field">
        <text class="field-label">é¢è¯•æ—¶é—´ *</text>
        <picker
          mode="time"
          value="{{reviewForm.interviewTime}}"
          bindchange="onTimeChange"
        >
          <view class="picker-display">
            {{reviewForm.interviewTime || 'è¯·é€‰æ‹©é¢è¯•æ—¶é—´'}}
          </view>
        </picker>
      </view>

      <!-- é¢è¯•åœ°ç‚¹ -->
      <view class="form-field">
        <text class="field-label">é¢è¯•åœ°ç‚¹ *</text>
        <input
          class="field-input"
          placeholder="å¦‚ï¼šå…¬å¸Aä¼šè®®å®¤"
          value="{{reviewForm.interviewLocation}}"
          data-field="interviewLocation"
          bindinput="onInput"
        />
      </view>

      <!-- é¢è¯•è¦æ±‚ -->
      <view class="form-field">
        <text class="field-label">é¢è¯•è¦æ±‚</text>
        <textarea
          class="field-textarea"
          placeholder="å¦‚ï¼šè¯·å‡†å¤‡3åˆ†é’Ÿæ‰è‰ºå±•ç¤º"
          value="{{reviewForm.interviewRequirements}}"
          data-field="interviewRequirements"
          bindinput="onInput"
        />
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æŒ‰é’® -->
  <view class="footer-actions">
    <button class="btn-submit" bindtap="submitReview">
      æäº¤å®¡æ ¸
    </button>
  </view>

</view>

<!-- åŠ è½½ä¸­ -->
<view class="empty-state" wx:if="{{!candidate}}">
  <text class="empty-text">åŠ è½½ä¸­...</text>
</view>
