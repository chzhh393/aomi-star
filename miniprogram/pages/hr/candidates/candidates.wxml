<!--pages/hr/candidates/candidates.wxml-->
<view class="container">

  <!-- é¡¶éƒ¨æ¨ªå¹… -->
  <view class="header-banner">
    <view class="banner-slash"></view>
    <text class="banner-text">CANDIDATES</text>
  </view>

  <!-- ç»Ÿè®¡å¡ç‰‡ -->
  <view class="stats-card">
    <view class="stat-item">
      <text class="stat-number">{{stats.total}}</text>
      <text class="stat-label">æ€»æ•°</text>
    </view>
    <view class="stat-item">
      <text class="stat-number">{{stats.pending}}</text>
      <text class="stat-label">å¾…å®¡æ ¸</text>
    </view>
    <view class="stat-item">
      <text class="stat-number">{{stats.interview_scheduled}}</text>
      <text class="stat-label">é¢è¯•ä¸­</text>
    </view>
    <view class="stat-item">
      <text class="stat-number">{{stats.signed}}</text>
      <text class="stat-label">å·²ç­¾çº¦</text>
    </view>
  </view>

  <!-- ç­›é€‰æ ‡ç­¾ -->
  <view class="filter-section">
    <scroll-view class="filter-scroll" scroll-x>
      <view class="filter-tabs">
        <view
          class="filter-tab {{activeFilter === item.value ? 'active' : ''}}"
          wx:for="{{filterOptions}}"
          wx:key="value"
          data-filter="{{item.value}}"
          bindtap="switchFilter"
        >
          <text class="tab-text">{{item.label}}</text>
          <view class="tab-count" wx:if="{{activeFilter === item.value}}">
            {{item.value === 'all' ? stats.total : stats[item.value]}}
          </view>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- å€™é€‰äººåˆ—è¡¨ -->
  <view class="candidates-list">
    <view
      class="candidate-card"
      wx:for="{{filteredCandidates}}"
      wx:key="id"
      data-id="{{item.id}}"
      bindtap="viewDetail"
    >
      <!-- çŠ¶æ€è§’æ ‡ -->
      <view class="card-corner status-{{item.status}}"></view>

      <view class="card-content">
        <!-- å·¦ä¾§å¤´åƒå’Œä¿¡æ¯ -->
        <view class="candidate-info">
          <image class="avatar" src="{{item.images.face || '/assets/default-avatar.png'}}" mode="aspectFill" />
          <view class="info-text">
            <text class="name">{{item.basicInfo.artName}}</text>
            <view class="meta-row">
              <text class="meta-item">{{item.basicInfo.age}}å²</text>
              <text class="meta-dot">â—</text>
              <text class="meta-item">{{item.basicInfo.city}}</text>
            </view>
            <view class="talent-row">
              <text class="talent-label">{{item.talent.mainTalent}}</text>
              <text class="level-text">Lv.{{item.talent.level}}</text>
            </view>
          </view>
        </view>

        <!-- å³ä¾§è¯„åˆ† -->
        <view class="score-section">
          <view class="score-badge">
            <text class="score-number">{{item.aiScore.overallScore}}</text>
            <text class="score-label">AIåˆ†</text>
          </view>
          <view class="status-badge status-{{item.status}}">
            <text wx:if="{{item.status === 'pending'}}">å¾…å®¡æ ¸</text>
            <text wx:if="{{item.status === 'interview_scheduled'}}">å·²å®‰æ’é¢è¯•</text>
            <text wx:if="{{item.status === 'online_test_completed'}}">å·²å®Œæˆæµ‹è¯•</text>
            <text wx:if="{{item.status === 'pending_rating'}}">å¾…è¯„çº§</text>
            <text wx:if="{{item.status === 'rated'}}">å·²è¯„çº§</text>
            <text wx:if="{{item.status === 'signed'}}">å·²ç­¾çº¦</text>
            <text wx:if="{{item.status === 'training'}}">åŸ¹è®­ä¸­</text>
            <text wx:if="{{item.status === 'active'}}">æ­£å¼ä¸»æ’­</text>
            <text wx:if="{{item.status === 'rejected'}}">æœªé€šè¿‡</text>
          </view>
        </view>
      </view>

      <!-- åº•éƒ¨ä¿¡æ¯ -->
      <view class="card-footer">
        <!-- é¢è¯•æ—¶é—´ï¼ˆä»…å½“çŠ¶æ€ä¸ºå·²å®‰æ’é¢è¯•æ—¶æ˜¾ç¤ºï¼‰ -->
        <text class="footer-info" wx:if="{{item.status === 'interview_scheduled' && item.interviewSchedule}}">
          é¢è¯•æ—¶é—´ï¼š{{item.interviewSchedule.date}} {{item.interviewSchedule.time}}
        </text>
        <!-- HRå®¡æ ¸æ—¶é—´ï¼ˆå·²å®¡æ ¸çŠ¶æ€æ˜¾ç¤ºï¼‰ -->
        <text class="footer-info" wx:elif="{{item.hrReview}}">
          å®¡æ ¸æ—¶é—´ï¼š{{item.hrReview.reviewAt}}
        </text>
        <!-- ç”³è¯·æ—¶é—´ï¼ˆé»˜è®¤æ˜¾ç¤ºï¼‰ -->
        <text class="footer-info" wx:else>
          ç”³è¯·æ—¶é—´ï¼š{{item.createdAt}}
        </text>
        <text class="view-arrow">â†’</text>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{filteredCandidates.length === 0}}">
    <text class="empty-icon">ğŸ“­</text>
    <text class="empty-text">æš‚æ— å€™é€‰äºº</text>
  </view>

</view>
